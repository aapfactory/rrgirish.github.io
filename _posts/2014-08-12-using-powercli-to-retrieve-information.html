---
layout: post
title: Using PowerCLI to retrieve information on snapshots in your vSphere environment
date: '2014-08-12T22:05:00.001-07:00'
author: Girish Rao
tags:
- powercli
modified_time: '2014-10-12T00:00:38.629-07:00'
blogger_id: tag:blogger.com,1999:blog-984868599755994151.post-1570263628907090228
blogger_orig_url: http://www.virtualtipsntricks.com/2014/08/using-powercli-to-retrieve-information.html
---

<div dir="ltr" style="text-align: left;" trbidi="on"><div style="border: 0px none; color: #666666; font-family: proxima-nova, Arial, sans-serif; font-size: 14px; margin: 2px; orphans: 2; outline: 0px; padding: 0px; vertical-align: baseline; widows: 2;"><em style="background-color: white; border: 0px; line-height: 18px; margin: 0px; outline: 0px; padding: 0px; vertical-align: baseline;">I have a powershell script that emails me daily each VM that has a snapshot and the snapshot name. It integrates with powerCLI.</em></div><div style="border: 0px none; color: #666666; font-family: proxima-nova, Arial, sans-serif; font-size: 14px; margin: 2px; orphans: 2; outline: 0px; padding: 0px; vertical-align: baseline; widows: 2;"><em style="background-color: white; border: 0px; line-height: 18px; margin: 0px; outline: 0px; padding: 0px; vertical-align: baseline;">I use it to clean up obsolete snapshots.</em></div><div style="border: 0px none; color: #666666; font-family: proxima-nova, Arial, sans-serif; font-size: 14px; margin: 2px; orphans: 2; outline: 0px; padding: 0px; vertical-align: baseline; widows: 2;"><em style="background-color: white; border: 0px; line-height: 18px; margin: 0px; outline: 0px; padding: 0px; vertical-align: baseline;"><br /></em></div><div style="border: 0px none; color: #666666; font-family: proxima-nova, Arial, sans-serif; font-size: 14px; margin: 2px; orphans: 2; outline: 0px; padding: 0px; vertical-align: baseline; widows: 2;"><em style="background-color: white; border: 0px; line-height: 18px; margin: 0px; outline: 0px; padding: 0px; vertical-align: baseline;">Here is the script.</em></div><div style="border: 0px none; color: #666666; font-family: proxima-nova, Arial, sans-serif; font-size: 14px; height: 8pt; margin: 2px; min-height: 8pt; orphans: 2; outline: 0px; padding: 0px; vertical-align: baseline; widows: 2;"><br /></div><br />Get-VM | Select-Object -ExpandProperty Name | Out-File "C:\scripts\VMList.txt"<br />Get-Snapshot -VM (Get-Content C:\scripts\VMList.txt) | Select-Object VM,Name | Format-List | Out-file C:\scripts\ssmail.txt<br />Send-MailMessage -To "<a href="mailto:email@domain.com">email@domain.com</a>" -From "<a href="mailto:Noreply@domain.com">Noreply@domain.com</a>" -SmtpServer "IP address of email server or DNS name" - Subject "Snapshot Report" -Attachments C:\scripts\ssmail.txt</div>